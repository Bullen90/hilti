# $Id$
#
# @TEST-EXEC:  hilti-build %INPUT -o a.out 
# @TEST-EXEC:  ./a.out | sort | uniq -c | sort -n -k 2 >output 2>&1
# @TEST-EXEC:  test-diff output

module Main

import Hilti

global int32 c = 2

void func_with_globals() {
    c = int.mul c 2
    call Hilti::print (c)
}

void run() {
    thread.schedule 1 func_with_globals() 
    thread.schedule 2 func_with_globals() 
    thread.schedule 3 func_with_globals() 
    thread.schedule 4 func_with_globals() 
    thread.schedule 5 func_with_globals() 
    thread.schedule 1 func_with_globals() 
    thread.schedule 2 func_with_globals() 
    thread.schedule 3 func_with_globals() 
    thread.schedule 4 func_with_globals() 
    thread.schedule 5 func_with_globals() 
    thread.schedule 1 func_with_globals() 
    thread.schedule 2 func_with_globals() 
    thread.schedule 3 func_with_globals() 
    thread.schedule 4 func_with_globals() 
    thread.schedule 5 func_with_globals() 
}

